{
  "hash": "f2aab1f1dea931df4fe0296c87f30dd4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Cuaca yang Dikumpulkan oleh Tim Market Riset\"\nsubtitle: \"Penjelasan Singkat\"\nauthor: Dept. Market Riset\ninstitute: Nutrifood Indonesia\nformat: \n  html:\n    code-block-bg: true\n    code-block-border-left: true\n    code-fold: true\n    code-summary: \"Show me the code!\"\n    code-tools:\n      source: true\n      toggle: false\n      caption: none\n    theme: cyborg\n    toc: true\n    toc-depth: 3\n    toc-location: right\n    toc-title: Daftar Isi\n    highlight-style: breeze\neditor: visual\nexecute: \n  echo: true\n  warning: false\n  error: false\n---\n\n\n\n\n\n# PENDAHULUAN\n\n## Latar Belakang\n\n-   Tim market riset melakukan *pilot project* untuk mengambil data cuaca di beberapa kota di Indonesia sebagai **tabungan data** yang mungkin akan berguna suatu saat nanti.\n\n-   Temuan kualitatif saat survey terhadap **operator makanan dan minuman**:\n\n> Cuaca panas membuat konsumen membeli minuman seperti NutriSari. Kebalikannya, cuaca dingin membuat jualan minuman seperti NutriSari sepi.\n\n## Tujuan\n\nMengambil data cuaca di beberapa kota di Indonesia.\n\n## Metode\n\nData cuaca diambil dari situs [Open Weather Map](openweathermap.org) mengandalkan **API** yang disediakan. Data cuaca yang diambil adalah:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(df_final)[-1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"kota\"           \"kondisi\"        \"detail_kondisi\" \"suhu\"          \n [5] \"suhu_min\"       \"suhu_max\"       \"feel_like\"      \"humidity\"      \n [9] \"lon\"            \"lat\"            \"waktu\"         \n```\n\n\n:::\n:::\n\n\n\nKenapa mengambil data cuaca dari situs [Open Weather Map](openweathermap.org)? Alasannya:\n\n1.  **BMKG**:\n    -   **API** dari situs **BMKG** tidak *reliable* dan sulit digunakan.\n    -   Tidak ada data *real feel* di situs **BMKG**.\n2.  [Open Weather Map](openweathermap.org):\n    -   API dari [Open Weather Map](openweathermap.org) cukup *reliable* untuk diambil datanya **per tiga jam**.\n    -   Ada data *real feel*.\n    -   Cakupan kota lumayan.\n    -   Proses *scrape* bisa dilakukan otomatis tanpa supervisi sama sekali.\n\n# DATA YANG DIAMBIL\n\n## Kota\n\nBerikut adalah kota yang diambil data cuacanya:\n\n\n\n::: {.cell}\n- Ambon City\n- Balikpapan\n- Banda Aceh\n- Bandar Lampung\n- Bandung\n- Banjarmasin\n- Bekasi\n- Bima\n- Bitung\n- Bogor\n- Cirebon\n- Denpasar\n- Depok\n- Gorontalo\n- Gresik\n- Jakarta\n- Jayapura\n- Kendari\n- Kupang\n- Makassar\n- Malang\n- Manado\n- Medan\n- Metro\n- Padang\n- Palembang\n- Palu\n- Pekanbaru\n- Pontianak\n- Pringsewu\n- Probolinggo\n- Samarinda\n- Semarang\n- Sidoarjo\n- Solo\n- Sorong\n- Surabaya\n- Tangerang\n- Tangerang Selatan\n- Tasikmalaya\n- Tebing Tinggi\n- Yogyakarta\n:::\n\n\n\nKota-kota yang diambil merupakan representasi dari area-area _sales_ di Nutrifood. Beberapa kota baru ditambahkan setelah lebaran 2024 lalu.\n\n## Sampel Data\n\n\n\n\n\n\n\nPada bagian ini, kita akan melihat data cuaca di beberapa kota berikut. Namun saya akan menggunakan data pada waktu jam kerja, yakni __pukul 08.00 - 18.00__ di kota masing-masing.\n\n### Sebaran Data\n\nBerikut adalah sebaran data di beberapa kota di Indonesia:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbikin_sebaran(\"Semarang\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nbikin_sebaran(\"Jakarta\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-5-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nbikin_sebaran(\"Surabaya\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-5-3.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n### *Trend Feel Like*\n\nBerikut adalah *trend feel like* dari beberapa kota di Indonesia berikut:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbikin_grafik(\"Semarang\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"Jakarta\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-6-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"Surabaya\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-6-3.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"Solo\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-6-4.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n### *Trend Humidity*\n\nBerikut adalah *trend humidity* dari beberapa kota di Indonesia berikut:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbikin_grafik_2(\"Semarang\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik_2(\"Jakarta\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-7-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik_2(\"Surabaya\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-7-3.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Data Rata-Rata\n\nBerikut adalah 10 kota dengan rata-rata *feel like* tertinggi di setiap bulannya.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_bulan = \n  df_final %>%\n  mutate(jam = lubridate::hour(waktu)) |>\n  filter(jam >= 8 & jam <= 18) |>\n  mutate(bulan = lubridate::month(waktu)) %>% \n  group_by(bulan,kota) %>% \n  summarise(suhu_mean   = mean(feel_like),\n            suhu_median = median(feel_like)) %>% \n  ungroup() %>% \n  group_split(bulan)\n\nlist_bulan[[1]] %>% arrange(desc(suhu_mean)) |> head(10) %>% knitr::kable(caption = \"Januari 2024\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Januari 2024\n\n| bulan|kota              | suhu_mean| suhu_median|\n|-----:|:-----------------|---------:|-----------:|\n|     1|Depok             |  31.52693|      31.760|\n|     1|Tangerang Selatan |  31.19168|      30.920|\n|     1|Sidoarjo          |  31.02669|      31.100|\n|     1|Gresik            |  30.96315|      31.115|\n|     1|Semarang          |  30.79232|      30.520|\n|     1|Bogor             |  30.58766|      31.310|\n|     1|Jakarta           |  30.26211|      30.080|\n|     1|Tangerang         |  30.19167|      30.050|\n|     1|Bekasi            |  29.98045|      29.285|\n|     1|Probolinggo       |  29.75355|      29.875|\n\n\n:::\n\n```{.r .cell-code}\nlist_bulan[[2]] %>% arrange(desc(suhu_mean)) |> head(10) %>% knitr::kable(caption = \"Februari 2024\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Februari 2024\n\n| bulan|kota              | suhu_mean| suhu_median|\n|-----:|:-----------------|---------:|-----------:|\n|     2|Depok             |  31.71008|      31.610|\n|     2|Tangerang Selatan |  31.68156|      31.330|\n|     2|Gresik            |  31.15560|      32.120|\n|     2|Jakarta           |  31.14108|      30.755|\n|     2|Semarang          |  31.11647|      31.700|\n|     2|Bekasi            |  30.86275|      30.865|\n|     2|Tangerang         |  30.85537|      30.510|\n|     2|Sidoarjo          |  30.79842|      31.100|\n|     2|Bogor             |  30.25397|      30.525|\n|     2|Surabaya          |  30.17874|      29.410|\n\n\n:::\n\n```{.r .cell-code}\nlist_bulan[[3]] %>% arrange(desc(suhu_mean)) |> head(10) %>% knitr::kable(caption = \"Maret 2024\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Maret 2024\n\n| bulan|kota              | suhu_mean| suhu_median|\n|-----:|:-----------------|---------:|-----------:|\n|     3|Semarang          |  31.72659|      31.085|\n|     3|Surabaya          |  31.20299|      31.070|\n|     3|Sidoarjo          |  31.16288|      31.100|\n|     3|Tangerang Selatan |  31.11708|      30.680|\n|     3|Depok             |  30.92832|      30.530|\n|     3|Gresik            |  30.86065|      30.800|\n|     3|Jakarta           |  30.50947|      30.120|\n|     3|Bekasi            |  30.23039|      29.640|\n|     3|Bogor             |  30.13645|      30.515|\n|     3|Tangerang         |  30.00109|      29.530|\n\n\n:::\n\n```{.r .cell-code}\nlist_bulan[[4]] %>% arrange(desc(suhu_mean)) |> head(10) %>% knitr::kable(caption = \"April 2024\")\n```\n\n::: {.cell-output-display}\n\n\nTable: April 2024\n\n| bulan|kota              | suhu_mean| suhu_median|\n|-----:|:-----------------|---------:|-----------:|\n|     4|Ambon City        |  32.66118|      33.820|\n|     4|Semarang          |  32.61458|      32.460|\n|     4|Tangerang Selatan |  32.56475|      31.900|\n|     4|Jakarta           |  31.95322|      31.440|\n|     4|Tangerang         |  31.86941|      31.740|\n|     4|Surabaya          |  31.81139|      31.730|\n|     4|Sidoarjo          |  31.71476|      31.770|\n|     4|Depok             |  31.64525|      31.180|\n|     4|Bekasi            |  31.52883|      30.955|\n|     4|Gresik            |  31.47342|      31.110|\n\n\n:::\n\n```{.r .cell-code}\nlist_bulan[[5]] %>% arrange(desc(suhu_mean)) |> head(10) %>% knitr::kable(caption = \"Mei 2024\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Mei 2024\n\n| bulan|kota              | suhu_mean| suhu_median|\n|-----:|:-----------------|---------:|-----------:|\n|     5|Kupang            |  35.45865|      35.820|\n|     5|Tangerang Selatan |  33.58508|      33.280|\n|     5|Semarang          |  33.45933|      33.450|\n|     5|Bekasi            |  33.21984|      32.640|\n|     5|Jakarta           |  33.21677|      32.350|\n|     5|Tangerang         |  32.93889|      32.910|\n|     5|Depok             |  32.65730|      32.180|\n|     5|Solo              |  32.63700|      33.425|\n|     5|Bogor             |  31.74817|      32.045|\n|     5|Banda Aceh        |  31.71058|      31.660|\n\n\n:::\n:::\n\n\n\n# _FEEL LIKE_ DI AREA _SALES_\n\n## Perbandingan Suhu Harian Per Area\n\nPada bagian ini, kita akan kelompokkan semua kota yang ada ke dalam kelompok area *sales* Nutrifood. Kita akan lihat apakah ada area yang memiliki suhu lebih panas (dan signifikan) dibandingkan dengan area yang lain.\n\n\n\n\n\n\n\nBerikut adalah _area sales_ yang dimiliki Nutrifood:\n\n\n\n::: {.cell}\n- BARA\n- IBT\n- JABAR\n- Jabodetabek\n- JATENG\n- JATIM\n- KALIMANTAN\n- PUMA\n- SUM1\n- SUM2\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbikin_grafik(\"SUM1\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"SUM2\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"PUMA\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"BARA\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"IBT\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-5.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"Jabodetabek\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-6.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"JABAR\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-7.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"JATENG\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-8.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"JATIM\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-9.png){width=672}\n:::\n\n```{.r .cell-code}\nbikin_grafik(\"KALIMANTAN\")\n```\n\n::: {.cell-output-display}\n![](report_files/figure-html/unnamed-chunk-11-10.png){width=672}\n:::\n:::\n\n\n\nJika terlihat, ada beberapa area _sales_ yang memiliki tren mendatar dan tren yang berubah-ubah. \n\nPertanyaannya adalah:\n\n> __Apakah ada perbedaan signifikan suhu feel like antar area tersebut?__\n\n## Uji Hipotesis\n\nPada pengujian hipotesis kali ini, kita akan gunakan metode statistika non parametrik sehingga tidak perlu pengujian normalitas, cukup menggunakan _data as it is_.\n\n### Kruskal Wallis\n\nTahapan uji hipotesis:\n\n1. $H_0$, yakni __tidak ada perbedaan rata-rata__ _feel like_ di semua area.\n1. $H_1$, yakni __ada perbedaan rata-rata__ _feel like_ di semua area.\n1. Hitung statistika uji, dalam hal ini adalah _p value_.\n1. Ambil kesimpulan dari nilai _p value_ tersebut.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuji = kruskal.test(feel_like~area_sales,df_area_all)\nuji  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  feel_like by area_sales\nKruskal-Wallis chi-squared = 1300.3, df = 9, p-value < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\np_val_1 = uji[[3]] * 100\np_val_2 = round(p_val_1,0)\n```\n:::\n\n\n\nKita dapatkan bahwa _p value_ sebesar 2.6328309\\times 10^{-272} alias __0__ yang berarti __tolak__ $H_0$.\n\n> Ada perbedaan rata-rata _feel like_ di semua area.\n\nBerarti setidaknya ada satu area yang memiliki rata-rata _feel like_ yang berbeda dengan area yang lain.\n\n### Area yang Mana?\n\nUntuk menjawabnya, kita akan gunakan __Wilcox Text__ untu menguji rata-rata _feel like_ dari semua pasangan area yang ada.\n\nBerikut adalah hasilnya:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninput_func = c(\"JABAR\",\"JATENG\")\n\nhitung_pasang = function(input_func){\n  df_new = df_area_all |> filter(area_sales %in% input_func)\n  hasil  = wilcox.test(feel_like~area_sales,df_new)\n  p_val  = hasil$p.value\n  # tulis kesimpulan\n  kesimpulan = ifelse(p_val < 0.05,\"Beda\",\"Sama\")\n  return(kesimpulan)\n}\n\n# kita buat summary dulu ya\ndf_area_all |>\n  group_by(area_sales) |>\n  summarise(rata = mean(feel_like)) |>\n  ungroup() |>\n  mutate(rata = round(rata,2)) |>\n  knitr::kable()\n```\n\n::: {.cell-output-display}\n\n\n|area_sales  |  rata|\n|:-----------|-----:|\n|BARA        | 31.50|\n|IBT         | 29.94|\n|JABAR       | 25.05|\n|JATENG      | 29.34|\n|JATIM       | 29.80|\n|Jabodetabek | 31.21|\n|KALIMANTAN  | 28.97|\n|PUMA        | 30.60|\n|SUM1        | 28.41|\n|SUM2        | 27.81|\n\n\n:::\n\n```{.r .cell-code}\ndata_area_pair = \n  expand.grid(area_sales_new,area_sales_new) |>\n  as.data.frame() |>\n  rename(area_1 = Var1,\n         area_2 = Var2) |>\n  filter(area_1 != area_2) |>\n  mutate(area_1 = as.character(area_1),\n         area_2 = as.character(area_2))\n\ninput_list = vector(\"list\",nrow(data_area_pair))\n\nfor(i in 1:nrow(data_area_pair)){\n  input_list[[i]] = c(data_area_pair$area_1[i],\n                      data_area_pair$area_2[i])\n}\n\nlibrary(parallel)\nn_core = detectCores()\noutput = mclapply(input_list,hitung_pasang,mc.cores = n_core) |> unlist()\ndata_area_pair$kesimpulan = output\n\ndata_area_pair |>\n  reshape2::dcast(area_1 ~ area_2, value.var = \"kesimpulan\") |>\n  knitr::kable()\n```\n\n::: {.cell-output-display}\n\n\n|area_1      |BARA |IBT  |JABAR |Jabodetabek |JATENG |JATIM |KALIMANTAN |PUMA |SUM1 |SUM2 |\n|:-----------|:----|:----|:-----|:-----------|:------|:-----|:----------|:----|:----|:----|\n|BARA        |NA   |Beda |Beda  |Sama        |Beda   |Beda  |Beda       |Sama |Beda |Beda |\n|IBT         |Beda |NA   |Beda  |Beda        |Beda   |Sama  |Beda       |Beda |Beda |Beda |\n|JABAR       |Beda |Beda |NA    |Beda        |Beda   |Beda  |Beda       |Beda |Beda |Beda |\n|Jabodetabek |Sama |Beda |Beda  |NA          |Beda   |Beda  |Beda       |Beda |Beda |Beda |\n|JATENG      |Beda |Beda |Beda  |Beda        |NA     |Beda  |Sama       |Beda |Beda |Beda |\n|JATIM       |Beda |Sama |Beda  |Beda        |Beda   |NA    |Beda       |Beda |Beda |Beda |\n|KALIMANTAN  |Beda |Beda |Beda  |Beda        |Sama   |Beda  |NA         |Beda |Sama |Beda |\n|PUMA        |Sama |Beda |Beda  |Beda        |Beda   |Beda  |Beda       |NA   |Beda |Beda |\n|SUM1        |Beda |Beda |Beda  |Beda        |Beda   |Beda  |Sama       |Beda |NA   |Beda |\n|SUM2        |Beda |Beda |Beda  |Beda        |Beda   |Beda  |Beda       |Beda |Beda |NA   |\n\n\n:::\n:::\n",
    "supporting": [
      "report_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}